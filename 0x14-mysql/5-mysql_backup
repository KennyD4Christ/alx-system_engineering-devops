#!/usr/bin/env bash
# This script generates a MySQL dump and creates a compressed archive out of it.

# Check if password argument is provided
if [ -z "$1" ]; then
	echo "Please provide the MySQL root password as an argument."
	exit 1
fi

# Define variables
MYSQL_ROOT_PASSWORD=$1
BACKUP_DIR="$HOME"

# Create backup directory if it doesn't exist
mkdir -p "$BACKUP_DIR"

# Generate MySQL dump
mysqldump -u root -p"$MYSQL_ROOT_PASSWORD" --all-databases > "$BACKUP_DIR"/backup.sql

# Create compressed archive with timestamp
TIMESTAMP=$(date +'%d-%m-%Y')
tar -czvf "$BACKUP_DIR"/"$TIMESTAMP".tar.gz "$BACKUP_DIR"/backup.sql

# Remove the uncompressed dump file
rm "$BACKUP_DIR"/backup.sql

echo "MySQL dump created and compressed successfully."
